<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>SpringCloud MicroServices Practice | Hello World</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="SpringCloud MicroServices Practice" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="springcloud当前主流的微服务框架,基于核心思想是约定大于配置的springboot,使其在初期搭建及开发过程都变得简单易用,开发人员只需要少量的代码就可以实现特定服务. springcloud包含一套组件,贯穿整个微服务生命周期,从服务注册,服务发现,服务过滤,服务分发,服务调用,服务容错,服务追踪,有了全家桶再搭配一套前端框架,可以让系统更加高内聚低耦合可扩展." />
<meta property="og:description" content="springcloud当前主流的微服务框架,基于核心思想是约定大于配置的springboot,使其在初期搭建及开发过程都变得简单易用,开发人员只需要少量的代码就可以实现特定服务. springcloud包含一套组件,贯穿整个微服务生命周期,从服务注册,服务发现,服务过滤,服务分发,服务调用,服务容错,服务追踪,有了全家桶再搭配一套前端框架,可以让系统更加高内聚低耦合可扩展." />
<link rel="canonical" href="http://localhost:4000/jekyll/update/2020/08/28/SpringCloud_MicroServices.html" />
<meta property="og:url" content="http://localhost:4000/jekyll/update/2020/08/28/SpringCloud_MicroServices.html" />
<meta property="og:site_name" content="Hello World" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-28T00:12:01+08:00" />
<script type="application/ld+json">
{"headline":"SpringCloud MicroServices Practice","dateModified":"2020-08-28T00:12:01+08:00","url":"http://localhost:4000/jekyll/update/2020/08/28/SpringCloud_MicroServices.html","datePublished":"2020-08-28T00:12:01+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/jekyll/update/2020/08/28/SpringCloud_MicroServices.html"},"description":"springcloud当前主流的微服务框架,基于核心思想是约定大于配置的springboot,使其在初期搭建及开发过程都变得简单易用,开发人员只需要少量的代码就可以实现特定服务. springcloud包含一套组件,贯穿整个微服务生命周期,从服务注册,服务发现,服务过滤,服务分发,服务调用,服务容错,服务追踪,有了全家桶再搭配一套前端框架,可以让系统更加高内聚低耦合可扩展.","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Hello World" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Hello World</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">SpringCloud MicroServices Practice</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-08-28T00:12:01+08:00" itemprop="datePublished">Aug 28, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>springcloud当前主流的微服务框架,基于核心思想是约定大于配置的springboot,使其在初期搭建及开发过程都变得简单易用,开发人员只需要少量的代码就可以实现特定服务.
springcloud包含一套组件,贯穿整个微服务生命周期,从服务注册,服务发现,服务过滤,服务分发,服务调用,服务容错,服务追踪,有了全家桶再搭配一套前端框架,可以让系统更加高内聚低耦合可扩展.</p>

<p>实现组件功能三部曲:
第一步:引入maven依赖
第二步:增加组件配置(支持yaml,properties,json等)
第三步:增加类及方法注解</p>

<p>springcloud八大组件基本使用:
1.eureka 服务注册中心
1.1 服务器端引入spring-cloud-starter-netflix-eureka-server,客户端引入spring-cloud-starter-netflix-eureka-client
1.2 resources目录下bootstrap.yml文件增加config:
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/
1.3 服务器端主类加注解@EnableEurekaServer,客户端主类加注解@EnableDiscoveryClient
备注:启动多个eureka server互相注册可以实现高可用
2.ribbon 负载均衡
2.1 eureka默认依赖或spring-cloud-netflix-ribbon
2.2 增加注解@LoadBalanced到restful方法上
3.feign 声明式服务调用
3.1 引入依赖 spring-cloud-starter-openfeign
3.2 主类增加@EnableFeignClients(basePackages = “$basePackages”)
3.3 restful类的调用增加扫描目标包 @ComponentScan(basePackages = “$basePackages”)
4.stream 消息驱动
4.1 引入依赖spring-cloud-starter-stream-rabbit
4.2 增加配置
spring:
  cloud:
    stream:
      bindings:
        myMessage:
          group: 
          content-type: application/json
4.3 StreamClient 增加@Input(StreamClient.INPUT)  @Output(StreamClient.OUTPUT)注解的方法
4.4 StreamReceiver类增加@EnableBinding(StreamClient.class)注解
5.config 配置中心
5.1 引入依赖 spring-cloud-config-server
5.2 增加config repository地址用户名和密码
spring:
  cloud:
    config:
      server:
        git:
5.3 主类加注解@EnableConfigServer
备注:1.仓库保存 service-profile.yml的配置文件.  2.支持git仓库触发rabbitmq后通过amqp动态更新服务配置. 
6.zuul API网关
6.1 引入依赖spring-cloud-starter-netflix-zuul
6.2 增加routing配置用于路由和过滤
zuul:
  sensitive-headers:
  routes:
    product: /myProduct/**
  ignored-patterns:
    - /product/product/ListForOrder</p>
<h1 id="myproduct">myProduct:</h1>
<h1 id="path-myproduct">path: /myProduct/**</h1>
<h1 id="serviceid-product">serviceId: product</h1>
<p>6.3 主类增加@EnableZuulProxy注解
6.4 作用方法增加注解    @RefreshScope  @ConfigurationProperties(“zuul”)
7.hystrix 服务容错
7.1 引入依赖spring-cloud-starter-netflix-hystrix
7.2 引入配置服务降级/熔断配置
hystrix:
  command:
    default:
      execution:
        isolation:
          thread:
            timeoutInMilliseconds: 5000
    getProductInfoList:
      execution:
        isolation:
          thread:
            timeoutInMilliseconds: 5000
feign:
  hystrix:
    enabled: true
7.3 主类使用EnableCircuitBreaker注解
7.4 熔断类增加@DefaultProperties(defaultFallback = “defaultFallback”)注解增加默认fallback方法
7.5 熔断方法前增加@HystrixCommand() 可增加多种配置
备注 hystrix-dashboard 用于查看服务状态 依赖为spring-cloud-starter-netflix-hystrix-dashboard
8.sleuth 链路监控
8.1 引入依赖spring-cloud-starter-sleuth
8.2 增加配置
spring:
  sleuth:
    sampler:</p>
<h1 id="percentage-1">percentage: 1</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  probability: 1 logging:   level:
org.springframework.cloud.openfeign: debug 9.zipkin 实时数据追踪,配合sleuth使用 --非springcloud组件 9.1 引入依赖spring-cloud-sleuth-zipkin 9.2 增加配置 spring:   zipkin:
base-url: http://localhost:9411
sender:
  type: web
</code></pre></div></div>

  </div><a class="u-url" href="/jekyll/update/2020/08/28/SpringCloud_MicroServices.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Hello World</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Hello World</li><li><a class="u-email" href="mailto:jimmywangking@163.com">jimmywangking@163.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jimmywangking"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jimmywangking</span></a></li><li><a href="https://www.twitter.com/none"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">none</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Say hello to world, then tough to live in.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
